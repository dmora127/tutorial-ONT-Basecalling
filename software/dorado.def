Bootstrap: docker
From: nvidia/cuda:13.0.1-base-ubuntu24.04

%files

    dorado-1.2.0-linux-x64.tar.gz /opt/dorado-1.2.0-linux-x64.tar.gz
    bedtools /opt/bedtools/bedtools

%post
    DEBIAN_FRONTEND=noninteractive

    # system packages
    apt-get update -y
    apt-get install -y python3-minimal curl
    curl -sS https://bootstrap.pypa.io/get-pip.py -o get-pip.py
    python3 get-pip.py --break-system-packages
    rm get-pip.py

    # install Dorado and POD5
    cd /opt/
    tar -zxvf dorado-1.2.0-linux-x64.tar.gz
    rm dorado-1.2.0-linux-x64.tar.gz

    # install POD5 using pip
    pip install pod5 --break-system-packages

%environment
    # set up environment for when using the container
    # add Dorado to $PATH variable for ease of use
    export PATH="/opt/dorado-1.2.0-linux-x64/bin/:$PATH"
    export PATH="/opt/bedtools/:$PATH"